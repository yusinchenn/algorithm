<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡Œç‚ºæ¨¹ (Behavior Tree) å®Œæ•´æ•™å­¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e1e1e 0%, #2d2d30 100%);
            color: #e0e0e0;
            line-height: 1.8;
        }

        /* å°è¦½åˆ— */
        nav {
            background: rgba(30, 30, 30, 0.95);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            padding: 1rem;
            gap: 1rem;
        }

        nav a {
            color: #61dafb;
            text-decoration: none;
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            transition: all 0.3s;
            font-weight: 500;
        }

        nav a:hover {
            background: #61dafb;
            color: #1e1e1e;
            transform: translateY(-2px);
        }

        /* å®¹å™¨ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* æ¨™é¡Œ */
        h1 {
            font-size: 3rem;
            text-align: center;
            margin: 3rem 0;
            background: linear-gradient(135deg, #61dafb, #21a1f1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        section {
            background: rgba(45, 45, 48, 0.8);
            border-radius: 15px;
            padding: 3rem;
            margin: 3rem 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(97, 218, 251, 0.1);
        }

        h2 {
            font-size: 2rem;
            color: #61dafb;
            margin-bottom: 1.5rem;
            border-left: 4px solid #61dafb;
            padding-left: 1rem;
        }

        h3 {
            font-size: 1.5rem;
            color: #21a1f1;
            margin: 2rem 0 1rem;
        }

        h4 {
            font-size: 1.2rem;
            color: #4ec9b0;
            margin: 1.5rem 0 0.5rem;
        }

        p {
            margin-bottom: 1rem;
            color: #d4d4d4;
        }

        /* ç¨‹å¼ç¢¼å€å¡Š */
        pre {
            background: #1e1e1e;
            border: 1px solid #3c3c3c;
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        code {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            color: #ce9178;
            font-size: 0.95rem;
        }

        .keyword { color: #569cd6; }
        .class-name { color: #4ec9b0; }
        .function { color: #dcdcaa; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }

        /* ç‰¹è‰²æ¡† */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .feature-card {
            background: rgba(97, 218, 251, 0.1);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(97, 218, 251, 0.3);
            transition: all 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(97, 218, 251, 0.2);
        }

        .feature-card h4 {
            color: #61dafb;
            margin: 0 0 0.5rem 0;
            font-size: 1.2rem;
        }

        /* æ¨¹ç‹€çµæ§‹ç¤ºæ„åœ– */
        .tree-diagram {
            background: #2d2d30;
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
            overflow-x: auto;
        }

        .tree-visual {
            font-family: monospace;
            color: #4ec9b0;
            white-space: pre;
            line-height: 1.6;
        }

        /* æŒ‰éˆ• */
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, #0e639c, #1177bb);
            color: white;
            padding: 1rem 2rem;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(14, 99, 156, 0.4);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(14, 99, 156, 0.6);
        }

        .btn-large {
            font-size: 1.3rem;
            padding: 1.5rem 3rem;
        }

        .text-center {
            text-align: center;
        }

        /* åˆ—è¡¨æ¨£å¼ */
        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin: 0.5rem 0;
            color: #d4d4d4;
        }

        /* ç¬¬ä¸‰ç¯€è¦–è¦ºåŒ–æ¼”ç¤ºå°ˆç”¨æ¨£å¼ */
        .demo-container {
            display: flex;
            gap: 2rem;
            margin: 2rem 0;
            background: #1e1e1e;
            border-radius: 10px;
            padding: 2rem;
        }

        .demo-sidebar {
            width: 300px;
            flex-shrink: 0;
        }

        .demo-canvas {
            flex: 1;
            min-height: 600px;
            max-height: 700px;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background-image: radial-gradient(#333 1px, transparent 1px);
            background-size: 20px 20px;
            border-radius: 8px;
            overflow: auto;
            position: relative;
        }

        .control-group {
            background: #333;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        .control-group h3 {
            margin: 0 0 1rem 0;
            font-size: 1.1rem;
            color: #61dafb;
        }

        label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
        }

        input[type="range"] {
            width: 100%;
            margin-top: 5px;
        }

        button {
            background: #0e639c;
            color: white;
            border: none;
            padding: 10px;
            width: 100%;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: 0.2s;
        }

        button:hover {
            background: #1177bb;
        }

        #log {
            font-family: monospace;
            font-size: 0.9rem;
            color: #ccc;
            max-height: 200px;
            overflow-y: auto;
            background: #000;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #444;
        }

        /* è¡Œç‚ºæ¨¹ç¯€é»è¦–è¦ºåŒ–æ¨£å¼ */
        .tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            transform: scale(0.85);
            transform-origin: center;
        }

        .node-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 5px;
            position: relative;
        }

        .children {
            display: flex;
            justify-content: center;
            margin-top: 15px;
            position: relative;
            gap: 5px;
        }

        .children::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            width: 2px;
            height: 8px;
            background: #555;
        }

        .node-container::before {
            content: '';
            position: absolute;
            top: -15px;
            left: 50%;
            width: 2px;
            height: 15px;
            background: #555;
        }

        .tree > .node-container::before {
            display: none;
        }

        .node {
            width: 120px;
            padding: 8px;
            background: #3c3c3c;
            border: 2px solid #555;
            border-radius: 6px;
            text-align: center;
            font-size: 0.85rem;
            position: relative;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            z-index: 2;
        }

        .node-type {
            font-size: 0.7rem;
            color: #aaa;
            margin-bottom: 3px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .node-name {
            font-weight: bold;
            font-size: 0.85rem;
        }

        /* ç‹€æ…‹é¡è‰² */
        .status-idle {
            border-color: #555;
            opacity: 0.7;
        }

        .status-running {
            border-color: #f1c40f;
            background: #4b4b2c;
            box-shadow: 0 0 10px #f1c40f;
            transform: scale(1.05);
            opacity: 1;
        }

        .status-success {
            border-color: #2ecc71;
            background: #1e3b26;
            box-shadow: 0 0 10px #2ecc71;
            opacity: 1;
        }

        .status-failure {
            border-color: #e74c3c;
            background: #3b1e1e;
            opacity: 0.5;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 1200px) {
            .demo-container {
                flex-direction: column;
            }

            .demo-sidebar {
                width: 100%;
            }

            .tree {
                transform: scale(0.75);
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 2rem;
                margin: 2rem 0;
            }

            h2 {
                font-size: 1.5rem;
            }

            section {
                padding: 1.5rem;
                margin: 1.5rem 0;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            pre {
                font-size: 0.85rem;
                padding: 1rem;
            }

            .btn-large {
                font-size: 1.1rem;
                padding: 1rem 2rem;
            }

            .demo-canvas {
                min-height: 400px;
                max-height: 500px;
            }

            .tree {
                transform: scale(0.65);
            }

            .node {
                width: 100px;
                font-size: 0.75rem;
                padding: 6px;
            }

            .node-type {
                font-size: 0.65rem;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.5rem;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }

            .tree {
                transform: scale(0.5);
            }

            .demo-canvas {
                min-height: 350px;
                max-height: 400px;
            }
        }

        /* é å°¾ */
        footer {
            text-align: center;
            padding: 2rem;
            color: #888;
            margin-top: 3rem;
        }
    </style>
</head>
<body>
    <nav>
        <ul>
            <li><a href="#section1">ä»€éº¼æ˜¯è¡Œç‚ºæ¨¹</a></li>
            <li><a href="#section2">æ ¸å¿ƒç¨‹å¼ç¢¼</a></li>
            <li><a href="#section3">è¦–è¦ºåŒ–æ¼”ç¤º</a></li>
            <li><a href="#section4">å¯¦éš›æ‡‰ç”¨</a></li>
        </ul>
    </nav>

    <div class="container">
        <h1>ğŸŒ³ è¡Œç‚ºæ¨¹ (Behavior Tree) å®Œæ•´æ•™å­¸</h1>

        <!-- ç¬¬ 1 ç¯€ï¼šä»€éº¼æ˜¯è¡Œç‚ºæ¨¹ -->
        <section id="section1">
            <h2>ç¬¬ 1 ç¯€ï¼šä»€éº¼æ˜¯è¡Œç‚ºæ¨¹ï¼ˆBehavior Treeï¼‰ï¼Ÿ</h2>

            <p>
                <strong>è¡Œç‚ºæ¨¹ï¼ˆBehavior Treeï¼Œç°¡ç¨± BTï¼‰</strong>æ˜¯ä¸€ç¨®ç”¨æ–¼ AI æ±ºç­–çš„æ¨¹ç‹€è³‡æ–™çµæ§‹ï¼Œå»£æ³›æ‡‰ç”¨æ–¼éŠæˆ²é–‹ç™¼ã€æ©Ÿå™¨äººæ§åˆ¶ç­‰é ˜åŸŸã€‚
                ç›¸æ¯”å‚³çµ±çš„<strong>æœ‰é™ç‹€æ…‹æ©Ÿï¼ˆFSMï¼‰</strong>ï¼Œè¡Œç‚ºæ¨¹å…·æœ‰æ›´å¥½çš„æ¨¡çµ„åŒ–ã€å¯é‡ç”¨æ€§å’Œå¯æ“´å±•æ€§ã€‚
            </p>

            <h3>ğŸ“Œ æ ¸å¿ƒæ¦‚å¿µ</h3>
            <p>
                è¡Œç‚ºæ¨¹ç”±<strong>ç¯€é»ï¼ˆNodeï¼‰</strong>çµ„æˆï¼Œæ¯å€‹ç¯€é»åœ¨åŸ·è¡Œæ™‚æœƒè¿”å›ä¸‰ç¨®ç‹€æ…‹ä¹‹ä¸€ï¼š
            </p>
            <ul>
                <li><strong>SUCCESSï¼ˆæˆåŠŸï¼‰</strong>ï¼šä»»å‹™æˆåŠŸå®Œæˆ</li>
                <li><strong>FAILUREï¼ˆå¤±æ•—ï¼‰</strong>ï¼šä»»å‹™å¤±æ•—</li>
                <li><strong>RUNNINGï¼ˆé‹è¡Œä¸­ï¼‰</strong>ï¼šä»»å‹™æ­£åœ¨åŸ·è¡Œä¸­ï¼Œå°šæœªå®Œæˆ</li>
            </ul>

            <h3>ğŸ¯ ä¸»è¦ç¯€é»é¡å‹</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ”¸ Selectorï¼ˆé¸æ“‡ç¯€é»ï¼‰</h4>
                    <p>é¡ä¼¼æ–¼<strong>ã€ŒORã€é‚è¼¯</strong>ï¼Œä¾åºåŸ·è¡Œå­ç¯€é»ï¼Œåªè¦æœ‰ä¸€å€‹æˆåŠŸå°±è¿”å›æˆåŠŸã€‚</p>
                    <p><em>ç”¨é€”ï¼šå„ªå…ˆç´šé¸æ“‡ï¼Œä¾‹å¦‚ã€Œæ”»æ“Š OR é€ƒè·‘ OR å·¡é‚ã€</em></p>
                </div>

                <div class="feature-card">
                    <h4>ğŸ”¹ Sequenceï¼ˆé †åºç¯€é»ï¼‰</h4>
                    <p>é¡ä¼¼æ–¼<strong>ã€ŒANDã€é‚è¼¯</strong>ï¼Œä¾åºåŸ·è¡Œå­ç¯€é»ï¼Œåªæœ‰å…¨éƒ¨æˆåŠŸæ‰è¿”å›æˆåŠŸã€‚</p>
                    <p><em>ç”¨é€”ï¼šæ­¥é©ŸåŸ·è¡Œï¼Œä¾‹å¦‚ã€Œé è¿‘ AND æ”»æ“Šã€</em></p>
                </div>

                <div class="feature-card">
                    <h4>ğŸƒ Conditionï¼ˆæ¢ä»¶ç¯€é»ï¼‰</h4>
                    <p>æª¢æŸ¥æŸå€‹æ¢ä»¶æ˜¯å¦æ»¿è¶³ï¼Œè¿”å›æˆåŠŸæˆ–å¤±æ•—ã€‚</p>
                    <p><em>ç¯„ä¾‹ï¼šã€Œæ•µäººæ˜¯å¦å¯è¦‹ï¼Ÿã€ã€Œè¡€é‡æ˜¯å¦ä½æ–¼ 30%ï¼Ÿã€</em></p>
                </div>

                <div class="feature-card">
                    <h4>âš¡ Actionï¼ˆå‹•ä½œç¯€é»ï¼‰</h4>
                    <p>åŸ·è¡Œå…·é«”å‹•ä½œï¼Œä¾‹å¦‚ç§»å‹•ã€æ”»æ“Šã€æ’­æ”¾å‹•ç•«ç­‰ã€‚</p>
                    <p><em>ç¯„ä¾‹ï¼šã€Œé–‹æ§ã€ã€Œå°‹æ‰¾æ©é«”ã€ã€Œå·¡é‚ã€</em></p>
                </div>
            </div>

            <h3>ğŸŒ² è¡Œç‚ºæ¨¹çµæ§‹ç¯„ä¾‹</h3>
            <div class="tree-diagram">
                <div class="tree-visual">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Selectorï¼ˆAI å¤§è…¦ï¼‰          â”‚
â”‚          é¸æ“‡å„ªå…ˆåŸ·è¡Œçš„è¡Œç‚º           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚               â”‚              â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”      â”Œâ”€â”€â”€â–¼â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
   â”‚ç”Ÿå­˜æ¨¡å¼â”‚      â”‚æˆ°é¬¥æ¨¡å¼â”‚     â”‚é–’ç½®å·¡é‚ â”‚
   â”‚Sequenceâ”‚      â”‚Sequenceâ”‚     â”‚ Action  â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”      â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”
   â”‚è¡€é‡<30%â”‚      â”‚çœ‹è¦‹æ•µäººâ”‚
   â”‚Conditionâ”‚     â”‚Conditionâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                      â”‚
                 â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
                 â”‚ Selector â”‚
                 â”‚ æ”»æ“Šç­–ç•¥ â”‚
                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
              â”‚               â”‚
         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
         â”‚è¿‘æˆ°çªè¥²  â”‚     â”‚é ç¨‹å°„æ“Šâ”‚
         â”‚Sequence  â”‚     â”‚ Action â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </div>
            </div>

            <h3>âœ¨ å„ªé»</h3>
            <ul>
                <li>âœ… <strong>æ¨¡çµ„åŒ–</strong>ï¼šæ¯å€‹å­æ¨¹å¯ä»¥ç¨ç«‹é–‹ç™¼èˆ‡æ¸¬è©¦</li>
                <li>âœ… <strong>å¯é‡ç”¨</strong>ï¼šç›¸åŒçš„è¡Œç‚ºå­æ¨¹å¯åœ¨å¤šå€‹ AI ä¸­ä½¿ç”¨</li>
                <li>âœ… <strong>æ˜“æ–¼èª¿è©¦</strong>ï¼šè¦–è¦ºåŒ–å·¥å…·å¯ä»¥æ¸…æ¥šçœ‹åˆ° AI æ±ºç­–æµç¨‹</li>
                <li>âœ… <strong>å‹•æ…‹æ€§</strong>ï¼šå¯ä»¥åœ¨é‹è¡Œæ™‚ä¿®æ”¹æ¨¹çµæ§‹</li>
                <li>âœ… <strong>å„ªå…ˆç´šæ˜ç¢º</strong>ï¼šé€é Selector è¼•é¬†å¯¦ç¾å„ªå…ˆç´šæ±ºç­–</li>
            </ul>
        </section>

        <!-- ç¬¬ 2 ç¯€ï¼šæ ¸å¿ƒç¨‹å¼ç¢¼ -->
        <section id="section2">
            <h2>ç¬¬ 2 ç¯€ï¼šè¡Œç‚ºæ¨¹ï¼ˆBehavior Treeï¼‰æ ¸å¿ƒç¨‹å¼ç¢¼</h2>

            <p>
                ä»¥ä¸‹æ˜¯ä¸€å€‹ç°¡æ½”çš„è¡Œç‚ºæ¨¹å¯¦ç¾ï¼ŒåŒ…å«åŸºç¤ç¯€é»é¡åˆ¥èˆ‡çµ„åˆç¯€é»ã€‚
            </p>

            <h3>ğŸ“¦ åŸºç¤ç¯€é»é¡åˆ¥</h3>
<pre><code><span class="comment">// ç¯€é»ç‹€æ…‹æšèˆ‰</span>
<span class="keyword">const</span> Status = {
    <span class="string">SUCCESS</span>: <span class="string">'SUCCESS'</span>,
    <span class="string">FAILURE</span>: <span class="string">'FAILURE'</span>,
    <span class="string">RUNNING</span>: <span class="string">'RUNNING'</span>,
    <span class="string">IDLE</span>: <span class="string">'IDLE'</span>
};

<span class="comment">// åŸºç¤ç¯€é»é¡åˆ¥</span>
<span class="keyword">class</span> <span class="class-name">Node</span> {
    <span class="function">constructor</span>(name) {
        <span class="keyword">this</span>.name = name;
        <span class="keyword">this</span>.status = Status.IDLE;
    }

    <span class="comment">// æ¯ä¸€å¹€åŸ·è¡Œçš„é‚è¼¯ï¼ˆæ‡‰ç”±å­é¡è¦†å¯«ï¼‰</span>
    <span class="function">tick</span>(blackboard) {
        <span class="keyword">return</span> Status.SUCCESS;
    }

    <span class="function">reset</span>() {
        <span class="keyword">this</span>.status = Status.IDLE;
    }
}</code></pre>

            <h3>ğŸ”¸ Selectorï¼ˆé¸æ“‡ç¯€é»ï¼‰</h3>
            <p>ä¾åºåŸ·è¡Œå­ç¯€é»ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€å€‹è¿”å› SUCCESS æˆ– RUNNING çš„ç¯€é»ã€‚</p>
<pre><code><span class="keyword">class</span> <span class="class-name">Selector</span> <span class="keyword">extends</span> <span class="class-name">Node</span> {
    <span class="function">constructor</span>(name, children = []) {
        <span class="keyword">super</span>(name);
        <span class="keyword">this</span>.children = children;
    }

    <span class="function">tick</span>(blackboard) {
        <span class="keyword">for</span> (<span class="keyword">const</span> child <span class="keyword">of</span> <span class="keyword">this</span>.children) {
            <span class="keyword">const</span> result = child.<span class="function">tick</span>(blackboard);
            <span class="keyword">if</span> (result !== Status.FAILURE) {
                <span class="keyword">return</span> result; <span class="comment">// SUCCESS æˆ– RUNNING</span>
            }
        }
        <span class="keyword">return</span> Status.FAILURE; <span class="comment">// å…¨éƒ¨å¤±æ•—</span>
    }
}</code></pre>

            <h3>ğŸ”¹ Sequenceï¼ˆé †åºç¯€é»ï¼‰</h3>
            <p>ä¾åºåŸ·è¡Œå­ç¯€é»ï¼Œåªæœ‰å…¨éƒ¨æˆåŠŸæ‰è¿”å› SUCCESSã€‚</p>
<pre><code><span class="keyword">class</span> <span class="class-name">Sequence</span> <span class="keyword">extends</span> <span class="class-name">Node</span> {
    <span class="function">constructor</span>(name, children = []) {
        <span class="keyword">super</span>(name);
        <span class="keyword">this</span>.children = children;
    }

    <span class="function">tick</span>(blackboard) {
        <span class="keyword">for</span> (<span class="keyword">const</span> child <span class="keyword">of</span> <span class="keyword">this</span>.children) {
            <span class="keyword">const</span> result = child.<span class="function">tick</span>(blackboard);
            <span class="keyword">if</span> (result !== Status.SUCCESS) {
                <span class="keyword">return</span> result; <span class="comment">// FAILURE æˆ– RUNNING</span>
            }
        }
        <span class="keyword">return</span> Status.SUCCESS; <span class="comment">// å…¨éƒ¨æˆåŠŸ</span>
    }
}</code></pre>

            <h3>ğŸƒ Conditionï¼ˆæ¢ä»¶ç¯€é»ï¼‰</h3>
<pre><code><span class="keyword">class</span> <span class="class-name">Condition</span> <span class="keyword">extends</span> <span class="class-name">Node</span> {
    <span class="function">constructor</span>(name, checkFn) {
        <span class="keyword">super</span>(name);
        <span class="keyword">this</span>.checkFn = checkFn;
    }

    <span class="function">tick</span>(blackboard) {
        <span class="keyword">return</span> <span class="keyword">this</span>.<span class="function">checkFn</span>(blackboard)
            ? Status.SUCCESS
            : Status.FAILURE;
    }
}</code></pre>

            <h3>âš¡ Actionï¼ˆå‹•ä½œç¯€é»ï¼‰</h3>
<pre><code><span class="keyword">class</span> <span class="class-name">Action</span> <span class="keyword">extends</span> <span class="class-name">Node</span> {
    <span class="function">constructor</span>(name, actionFn) {
        <span class="keyword">super</span>(name);
        <span class="keyword">this</span>.actionFn = actionFn;
    }

    <span class="function">tick</span>(blackboard) {
        <span class="keyword">const</span> result = <span class="keyword">this</span>.<span class="function">actionFn</span>(blackboard);
        <span class="keyword">return</span> result || Status.SUCCESS;
    }
}</code></pre>

            <h3>ğŸ® å»ºæ§‹ AI è¡Œç‚ºæ¨¹ç¯„ä¾‹</h3>
<pre><code><span class="comment">// å»ºç«‹ä¸€å€‹éŠæˆ² AI çš„è¡Œç‚ºæ¨¹</span>
<span class="keyword">const</span> aiTree = <span class="keyword">new</span> <span class="class-name">Selector</span>(<span class="string">"AI å¤§è…¦"</span>, [
    <span class="comment">// å„ªå…ˆåŸ·è¡Œï¼šç”Ÿå­˜æ¨¡å¼</span>
    <span class="keyword">new</span> <span class="class-name">Sequence</span>(<span class="string">"ç”Ÿå­˜æ¨¡å¼"</span>, [
        <span class="keyword">new</span> <span class="class-name">Condition</span>(<span class="string">"è¡€é‡ä½æ–¼ 30%?"</span>, bb => bb.hp < 30),
        <span class="keyword">new</span> <span class="class-name">Action</span>(<span class="string">"å°‹æ‰¾æ©é«”"</span>, bb => {
            console.<span class="function">log</span>(<span class="string">"å°‹æ‰¾æœ€è¿‘çš„æ©é«”..."</span>);
            <span class="keyword">return</span> Status.SUCCESS;
        })
    ]),

    <span class="comment">// æ¬¡è¦åŸ·è¡Œï¼šæˆ°é¬¥æ¨¡å¼</span>
    <span class="keyword">new</span> <span class="class-name">Sequence</span>(<span class="string">"æˆ°é¬¥æ¨¡å¼"</span>, [
        <span class="keyword">new</span> <span class="class-name">Condition</span>(<span class="string">"çœ‹è¦‹æ•µäºº?"</span>, bb => bb.visible),
        <span class="keyword">new</span> <span class="class-name">Action</span>(<span class="string">"é–‹æ§å°„æ“Š"</span>, bb => {
            console.<span class="function">log</span>(<span class="string">"ç °ï¼ç °ï¼"</span>);
            <span class="keyword">return</span> Status.SUCCESS;
        })
    ]),

    <span class="comment">// é è¨­ï¼šé–’ç½®å·¡é‚</span>
    <span class="keyword">new</span> <span class="class-name">Action</span>(<span class="string">"é–’æ™ƒå·¡é‚"</span>, bb => {
        console.<span class="function">log</span>(<span class="string">"å¹å£å“¨å·¡é‚ä¸­..."</span>);
        <span class="keyword">return</span> Status.SUCCESS;
    })
]);

<span class="comment">// åŸ·è¡Œè¡Œç‚ºæ¨¹</span>
<span class="keyword">const</span> blackboard = { hp: 100, visible: <span class="keyword">false</span> };
aiTree.<span class="function">tick</span>(blackboard); <span class="comment">// æ¯å¹€åŸ·è¡Œä¸€æ¬¡</span></code></pre>
        </section>

        <!-- ç¬¬ 3 ç¯€ï¼šè¦–è¦ºåŒ–æ¼”ç¤º -->
        <section id="section3">
            <h2>ç¬¬ 3 ç¯€ï¼šæ¼”ç®—æ³•è¦–è¦ºåŒ–æ¼”ç¤º</h2>

            <p>
                ä»¥ä¸‹æ˜¯ä¸€å€‹<strong>äº’å‹•å¼è¡Œç‚ºæ¨¹è¦–è¦ºåŒ–æ¼”ç¤º</strong>ï¼Œä½ å¯ä»¥ï¼š
            </p>
            <ul>
                <li>âœ… èª¿æ•´ç’°å¢ƒè®Šæ•¸ï¼ˆç©å®¶å¯è¦‹æ€§ã€è·é›¢ã€AI è¡€é‡ï¼‰</li>
                <li>âœ… è§€å¯Ÿ AI å¦‚ä½•æ ¹æ“šä¸åŒæ¢ä»¶åšå‡ºæ±ºç­–</li>
                <li>âœ… æŸ¥çœ‹å³æ™‚æ—¥èªŒè¼¸å‡ºèˆ‡ç¯€é»ç‹€æ…‹è®ŠåŒ–</li>
            </ul>

            <p style="margin-top: 1.5rem;">
                <strong>æ“ä½œèªªæ˜ï¼š</strong><br>
                - å‹¾é¸ã€Œç©å®¶å¯è¦‹ã€ä¸¦èª¿æ•´è·é›¢ï¼Œè§€å¯Ÿ AI æ”»æ“Šè¡Œç‚º<br>
                - å°‡è¡€é‡é™ä½è‡³ 30% ä»¥ä¸‹ï¼Œè§€å¯Ÿ AI é€²å…¥ç”Ÿå­˜æ¨¡å¼<br>
                - é»æ“Šã€Œè‡ªå‹•é‹è¡Œã€å¯ä»¥æŒçºŒåŸ·è¡Œè¡Œç‚ºæ¨¹
            </p>

            <div class="demo-container">
                <div class="demo-sidebar">
                    <div class="control-group">
                        <h3>ç’°å¢ƒè®Šæ•¸ (Blackboard)</h3>
                        <label>
                            ç©å®¶å¯è¦‹ (Visible)
                            <input type="checkbox" id="chk-visible">
                        </label>
                        <label>
                            è·é›¢ç©å®¶ (Distance)
                            <span id="val-dist">30m</span>
                        </label>
                        <input type="range" id="rng-dist" min="0" max="50" value="30">
                        <label>
                            è‡ªèº«è¡€é‡ (Health)
                            <span id="val-hp">100%</span>
                        </label>
                        <input type="range" id="rng-hp" min="0" max="100" value="100">
                    </div>

                    <div class="control-group">
                        <h3>åŸ·è¡Œæ§åˆ¶</h3>
                        <button id="btn-tick">åŸ·è¡Œä¸€æ¬¡ (Tick)</button>
                        <div style="margin-top:10px; display:flex; gap:10px;">
                            <button id="btn-auto" style="background:#2d8a56;">è‡ªå‹•é‹è¡Œ</button>
                            <button id="btn-reset" style="background:#d32f2f;">é‡ç½®ç‹€æ…‹</button>
                        </div>
                    </div>

                    <div class="control-group">
                        <h3>æ—¥èªŒ</h3>
                        <div id="log">ç­‰å¾…åŸ·è¡Œ...</div>
                    </div>
                </div>

                <div class="demo-canvas">
                    <div id="tree-root" class="tree"></div>
                </div>
            </div>
        </section>

        <!-- ç¬¬ 4 ç¯€ï¼šå¯¦éš›æ‡‰ç”¨é«”é©— -->
        <section id="section4">
            <h2>ç¬¬ 4 ç¯€ï¼šå¯¦éš›æ‡‰ç”¨é«”é©—</h2>

            <p>
                é«”é©—ä¸€å€‹<strong>çœŸå¯¦çš„éŠæˆ²å ´æ™¯</strong>ï¼Œå…¶ä¸­æ•µäºº AI ä½¿ç”¨è¡Œç‚ºæ¨¹ä¾†åšæ±ºç­–ï¼
            </p>

            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ¯ æ•µäºº AI è¡Œç‚º</h4>
                    <p>æ•µäººæœƒæ ¹æ“šä½ çš„ä½ç½®ã€è·é›¢å’Œè‡ªèº«è¡€é‡åšå‡ºä¸åŒæ±ºç­–</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ›¡ï¸ æˆ°è¡“æ±ºç­–</h4>
                    <p>ä½è¡€é‡æ™‚æœƒå°‹æ‰¾æ©é«”ï¼Œé«˜è¡€é‡æ™‚æœƒä¸»å‹•é€²æ”»</p>
                </div>
                <div class="feature-card">
                    <h4>âš”ï¸ æ”»æ“Šç­–ç•¥</h4>
                    <p>æ ¹æ“šè·é›¢é¸æ“‡è¿‘æˆ°æˆ–é ç¨‹æ”»æ“Š</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ”„ å‹•æ…‹åæ‡‰</h4>
                    <p>å³æ™‚æ ¹æ“šæˆ°å ´æƒ…æ³èª¿æ•´ç­–ç•¥</p>
                </div>
            </div>

            <p class="text-center" style="margin: 3rem 0;">
                <a href="game.html" class="btn btn-large">
                    ğŸ® é–‹å§‹éŠæˆ²é«”é©— â†’
                </a>
            </p>

            <p style="color: #888; text-align: center;">
                æç¤ºï¼šä½¿ç”¨ WASD éµç§»å‹•ï¼Œæ»‘é¼ é»æ“Šæ”»æ“Šï¼Œè§€å¯Ÿæ•µäººçš„ AI è¡Œç‚ºæ±ºç­–
            </p>
        </section>
    </div>

    <footer>
        <p>Â© 2024 è¡Œç‚ºæ¨¹æ•™å­¸å°ˆæ¡ˆ | Behavior Tree Tutorial</p>
        <p>ä½¿ç”¨ç¾ä»£ JavaScript èˆ‡ HTML5 Canvas æ§‹å»º</p>
    </footer>

    <script>
        // --- è¡Œç‚ºæ¨¹æ ¸å¿ƒé¡åˆ¥ ---
        const Status = { SUCCESS: 'SUCCESS', FAILURE: 'FAILURE', RUNNING: 'RUNNING', IDLE: 'IDLE' };

        class Node {
            constructor(name) {
                this.name = name;
                this.status = Status.IDLE;
                this.element = null;
            }

            tick(blackboard) {
                return Status.SUCCESS;
            }

            setStatus(status) {
                this.status = status;
                this.updateVisual();
            }

            reset() {
                this.status = Status.IDLE;
                this.updateVisual();
            }

            render() {
                const el = document.createElement('div');
                el.className = 'node-container';

                const nodeBox = document.createElement('div');
                nodeBox.className = 'node status-idle';
                nodeBox.innerHTML = `<div class="node-type">${this.constructor.name}</div><div class="node-name">${this.name}</div>`;

                this.element = nodeBox;
                el.appendChild(nodeBox);
                return el;
            }

            updateVisual() {
                if(!this.element) return;
                this.element.className = `node status-${this.status.toLowerCase()}`;
            }
        }

        class Composite extends Node {
            constructor(name, children = []) {
                super(name);
                this.children = children;
            }

            render() {
                const el = super.render();
                const childrenContainer = document.createElement('div');
                childrenContainer.className = 'children';
                this.children.forEach(child => {
                    childrenContainer.appendChild(child.render());
                });
                el.appendChild(childrenContainer);
                return el;
            }

            reset() {
                super.reset();
                this.children.forEach(c => c.reset());
            }
        }

        class Selector extends Composite {
            tick(bb) {
                this.setStatus(Status.RUNNING);
                for (const child of this.children) {
                    const result = child.tick(bb);
                    if (result !== Status.FAILURE) {
                        this.setStatus(result);
                        return result;
                    }
                }
                this.setStatus(Status.FAILURE);
                return Status.FAILURE;
            }
        }

        class Sequence extends Composite {
            tick(bb) {
                this.setStatus(Status.RUNNING);
                for (const child of this.children) {
                    const result = child.tick(bb);
                    if (result !== Status.SUCCESS) {
                        this.setStatus(result);
                        return result;
                    }
                }
                this.setStatus(Status.SUCCESS);
                return Status.SUCCESS;
            }
        }

        class Condition extends Node {
            constructor(name, checkFn) {
                super(name);
                this.checkFn = checkFn;
            }
            tick(bb) {
                const result = this.checkFn(bb) ? Status.SUCCESS : Status.FAILURE;
                this.setStatus(result);
                return result;
            }
        }

        class Action extends Node {
            constructor(name, actionFn) {
                super(name);
                this.actionFn = actionFn;
            }
            tick(bb) {
                const result = this.actionFn(bb);
                this.setStatus(result || Status.SUCCESS);
                return result || Status.SUCCESS;
            }
        }

        // --- æ§‹å»ºè¡Œç‚ºæ¨¹ ---
        const tree = new Selector("AI å¤§è…¦", [
            new Sequence("ç”Ÿå­˜æ¨¡å¼", [
                new Condition("è¡€é‡ < 30%?", (bb) => bb.hp < 30),
                new Action("å°‹æ‰¾æ©é«”", (bb) => { log("æ­£åœ¨å°‹æ‰¾æœ€è¿‘çš„æ©é«”..."); return Status.SUCCESS; }),
                new Action("ç§»å‹•ä¸¦æ²»ç™‚", (bb) => { log("ç§»å‹•ä¸­...æ‰“è—¥ä¸­..."); return Status.RUNNING; })
            ]),

            new Sequence("æˆ°é¬¥æ¨¡å¼", [
                new Condition("çœ‹è¦‹ç©å®¶?", (bb) => bb.visible),
                new Selector("æ”»æ“Šç­–ç•¥", [
                    new Sequence("è¿‘æˆ°çªè¥²", [
                        new Condition("è·é›¢ < 10m?", (bb) => bb.dist < 10),
                        new Action("æ®åˆ€æ”»æ“Š", (bb) => { log("æ®åˆ€æ”»æ“Šï¼"); return Status.SUCCESS; })
                    ]),
                    new Action("é–‹æ§å°„æ“Š", (bb) => { log("ç °ï¼ç °ï¼"); return Status.SUCCESS; })
                ])
            ]),

            new Action("é–’æ™ƒå·¡é‚", (bb) => { log("å¹å£å“¨å·¡é‚ä¸­..."); return Status.SUCCESS; })
        ]);

        // --- UI ç¶å®š ---
        document.getElementById('tree-root').appendChild(tree.render());

        const blackboard = {
            visible: false,
            dist: 30,
            hp: 100
        };

        const chkVisible = document.getElementById('chk-visible');
        const rngDist = document.getElementById('rng-dist');
        const rngHp = document.getElementById('rng-hp');
        const valDist = document.getElementById('val-dist');
        const valHp = document.getElementById('val-hp');
        const logEl = document.getElementById('log');

        function updateBlackboard() {
            blackboard.visible = chkVisible.checked;
            blackboard.dist = parseInt(rngDist.value);
            blackboard.hp = parseInt(rngHp.value);

            valDist.textContent = blackboard.dist + "m";
            valHp.textContent = blackboard.hp + "%";
        }

        [chkVisible, rngDist, rngHp].forEach(el => el.addEventListener('input', updateBlackboard));

        function log(msg) {
            const line = document.createElement('div');
            line.textContent = `> ${msg}`;
            logEl.prepend(line);
        }

        function tickTree() {
            tree.reset();
            log("--- Tick ---");
            tree.tick(blackboard);
        }

        document.getElementById('btn-tick').addEventListener('click', tickTree);
        document.getElementById('btn-reset').addEventListener('click', () => {
            tree.reset();
            logEl.innerHTML = 'å·²é‡ç½®';
        });

        let autoInterval = null;
        document.getElementById('btn-auto').addEventListener('click', function() {
            if(autoInterval) {
                clearInterval(autoInterval);
                autoInterval = null;
                this.textContent = "è‡ªå‹•é‹è¡Œ";
                this.style.background = "#2d8a56";
            } else {
                tickTree();
                autoInterval = setInterval(tickTree, 1000);
                this.textContent = "åœæ­¢é‹è¡Œ";
                this.style.background = "#e67e22";
            }
        });

        // å¹³æ»‘æ»¾å‹•åˆ°éŒ¨é»
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
